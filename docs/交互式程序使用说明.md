# 简化交互式程序使用说明

## 概述

`simple_interactive.py` 是一个简化的交互式主控程序，直接调用10个核心处理程序，提供了友好的用户界面来执行志愿者排表系统的各个功能模块。

## 启动方式

```bash
# 方式一：直接运行
python simple_interactive.py

# 方式二：使用启动脚本
python run_interactive.py
```

## 主菜单

程序启动后会显示以下菜单：

```
============================================================
           志愿者排表系统 - 主菜单
============================================================

【面试结果收集模块】
  (1) 汇总面试打分表
  (2) 分离已面试和未面试人员

【排表模块】
  (3) 基本信息核查和收集
  (4) 正式普通志愿者和储备志愿者拆分
  (5) 家属志愿者资格审查
  (6) 情侣志愿者资格核查
  (7) 小组划分及组长分配
  (8) 绑定集合生成
  (9) 排表主程序
  (10) 总表拆分和表格整合

【其他选项】
  (h) 帮助
  (q) 退出
============================================================
```

## 使用流程

### 1. 选择程序
输入对应的数字选择要执行的程序，例如输入 `1` 选择"汇总面试打分表"。

### 2. 查看输入文件
系统会自动显示该程序需要的所有输入文件路径，例如：

```
程序 1: 汇总面试打分表
==================================================
需要的输入文件路径：
  [存在] 面试打分表目录: input\面试打分表 (目录)
  [存在] 统一面试打分表输出路径: pipeline\01_interview_results\统一面试打分表.xlsx (40.2 KB)
==================================================
```

### 3. 确认文件存在
检查显示的文件路径：
- `[存在]` 表示文件存在并显示文件大小
- `[缺失]` 表示文件不存在

### 4. 执行确认
系统会询问：`是否确定所有输入文件都存在？(y/n)`

- 输入 `y` 或 `yes` 或 `是`：开始执行程序
- 输入 `n` 或 `no` 或 `否`：取消操作

### 5. 查看结果
- 执行成功：显示"程序 X 执行成功！"
- 执行失败：显示"程序 X 执行失败，请查看日志了解详情"

## 10个核心程序说明

### 面试结果收集模块

** (1) 汇总面试打分表**
- 功能：将多个面试官的打分表合并为一个统一表格
- 输入：面试打分表目录
- 输出：统一面试打分表.xlsx

** (2) 分离已面试和未面试人员**
- 功能：根据面试结果分离志愿者
- 输入：普通志愿者招募表、统一面试打分表
- 输出：已面试志愿者表、未面试志愿者表

### 排表模块

** (3) 基本信息核查和收集**
- 功能：检查重复信息并收集元数据
- 输入：所有志愿者表格、岗位表、委派名单
- 输出：查重报告、metadata.json

** (4) 正式普通志愿者和储备志愿者拆分**
- 功能：根据面试成绩拆分志愿者
- 输入：普通志愿者表、metadata.json、面试汇总表
- 输出：正式志愿者表、储备志愿者表

** (5) 家属志愿者资格审查**
- 功能：检查家属志愿者资格
- 输入：家属志愿者表、内部志愿者表
- 输出：家属资格审查报告

** (6) 情侣志愿者资格核查**
- 功能：检查情侣志愿者资格
- 输入：情侣志愿者表及各志愿者表
- 输出：情侣资格审查报告

** (7) 小组划分及组长分配**
- 功能：划分小组并分配组长
- 输入：岗位表、内部志愿者表、正式志愿者表
- 输出：小组划分结果

** (8) 绑定集合生成**
- 功能：生成情侣、家属、团体等绑定关系
- 输入：情侣表、家属表、团体表、委派名单
- 输出：绑定集合文件

** (9) 排表主程序**
- 功能：核心排班算法
- 输入：metadata.json、小组划分、绑定集合
- 输出：总表.xlsx

** (10) 总表拆分和表格整合**
- 功能：拆分总表并生成最终文件
- 输入：总表
- 输出：多个小组文件、大总表

## 推荐执行顺序

建议按以下顺序执行程序：

1. 程序 (1) - 汇总面试打分表
2. 程序 (2) - 分离已面试和未面试人员
3. 程序 (3) - 基本信息核查和收集
4. 程序 (4) - 正式普通志愿者和储备志愿者拆分
5. 程序 (5) - 家属志愿者资格审查
6. 程序 (6) - 情侣志愿者资格核查
7. 程序 (7) - 小组划分及组长分配
8. 程序 (8) - 绑定集合生成
9. 程序 (9) - 排表主程序
10. 程序 (10) - 总表拆分和表格整合

## 注意事项

### 文件路径
- 所有路径都基于项目根目录
- 输入文件主要位于 `input/` 目录
- 输出文件主要位于 `pipeline/` 和 `output/` 目录

### 错误处理
- 如果程序执行失败，请查看 `logs/` 目录中的日志文件
- 确保前置程序的输出文件存在再执行后续程序

### 系统要求
- Python 3.7+
- 已安装必要的依赖包
- 确保有足够的磁盘空间存储输出文件

### 帮助信息
- 输入 `h` 查看详细的帮助信息
- 输入 `q` 退出系统

## 文件结构

```
Bot/
├── simple_interactive.py      # 主交互程序
├── run_interactive.py         # 启动脚本
├── 简化交互式程序使用说明.md     # 本说明文档
├── src/                       # 核心处理程序
│   ├── interview/            # 面试模块
│   └── scheduling/           # 排表模块
├── input/                     # 输入文件目录
├── pipeline/                  # 中间处理结果
├── output/                    # 最终输出
└── logs/                      # 日志文件
```

## 故障排除

### 常见问题

1. **程序无法启动**
   - 检查Python版本是否正确
   - 确保在项目根目录运行

2. **找不到文件**
   - 检查文件路径是否正确
   - 确保输入文件存在于 `input/` 目录

3. **程序执行失败**
   - 查看日志文件了解详细错误信息
   - 检查前置程序是否已成功执行

4. **编码问题**
   - 确保文件名不包含特殊字符
   - 使用UTF-8编码保存文本文件

### 联系支持

如遇到无法解决的问题，请：
1. 查看日志文件了解详细错误
2. 检查输入文件格式是否正确
3. 确认系统环境配置正确

---

版本：v1.0.0
更新日期：2025-11-22